<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Futebol + Quiz Difícil ⚽🧠</title>
  <style>
    :root{
      --bg:#0b0c1e;      
      --card:#111827;
      --line:#1f2937;
      --accent:#00ffa6;
      --accent-2:#ffd400;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --danger:#ff5d5d;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:radial-gradient(1200px 700px at 50% -10%, #0f172a 0%, #020617 60%); 
      color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial; min-height:100dvh; display:grid; place-items:center;
    }
    .wrap{ width:min(1100px, 96vw); margin:auto; }
    header{ display:flex; align-items:center; justify-content:space-between; gap:1rem; padding:16px 10px 6px; }
    h1{ font-size:clamp(18px,2.6vw,28px); margin:0; letter-spacing:.5px; }
    .pill{ display:flex; gap:10px; align-items:center; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06); padding:8px 12px; border-radius:999px; font-size:14px; }
    .pill strong{ color:var(--accent); }

    .grid{ display:grid; grid-template-columns: 1.2fr .8fr; gap:16px; }
    @media (max-width: 900px){ .grid{ grid-template-columns:1fr; } }

    /* Campo / Gol */
    .stadium{ position:relative; isolation:isolate; background:linear-gradient(180deg, #0b4 0%, #083 100%); border-radius:18px; box-shadow:0 10px 40px rgba(0,0,0,.45), inset 0 0 0 2px rgba(255,255,255,.04); overflow:hidden; }
    .stadium::before{ content:""; position:absolute; inset:0; background:repeating-linear-gradient(90deg, rgba(255,255,255,.12) 0 2px, transparent 2px 46px); opacity:.08; }

    .goal-area{ position:relative; height:520px; padding:16px; }
    @media (max-width: 520px){ .goal-area{ height:64dvh; } }

    .goal{
      position:absolute; left:50%; transform:translateX(-50%);
      top:42px; width:min(70%, 580px); height:160px; border:4px solid #e5e7eb; border-bottom:none; border-radius:14px 14px 0 0; 
      box-shadow:0 8px 0 rgba(255,255,255,.3) inset; background:rgba(0,0,0,.02);
      cursor: not-allowed;
    }
    .goal.aim{ cursor: crosshair; }

    .net{ position:absolute; inset:0; background:linear-gradient( to right, transparent 0 12px, rgba(255,255,255,.5) 12px 13px),
                               linear-gradient( to bottom, transparent 0 12px, rgba(255,255,255,.5) 12px 13px );
           background-size:28px 28px; opacity:.25; pointer-events:none; }

    .box{ position:absolute; left:50%; transform:translateX(-50%); top:220px; width:min(80%, 640px); height:180px; border:2px dashed rgba(255,255,255,.35); border-radius:12px; }

    .keeper{ position:absolute; top:120px; width:100px; height:80px; background:linear-gradient(180deg,#38bdf8,#0369a1); border:3px solid #0ea5e9; 
             border-radius:12px; display:grid; place-items:center; font-weight:700; text-shadow:0 1px 0 #000; box-shadow:0 8px 20px rgba(0,0,0,.45); }

    .ball{ position:absolute; bottom:24px; left:50%; transform:translateX(-50%);
           width:42px; height:42px; border-radius:50%; background:radial-gradient(circle at 30% 30%, #fff 0 14px, #111 15px 16px, #fff 17px), #fff;
           box-shadow:0 8px 20px rgba(0,0,0,.45), 0 0 0 4px rgba(255,255,255,.08);
           transition: box-shadow .2s ease; }
    .ball.ready{ box-shadow:0 8px 20px rgba(0,0,0,.45), 0 0 0 4px rgba(0,255,166,.35); }

    .aim-hint{ position:absolute; left:50%; transform:translateX(-50%); bottom:72px; padding:6px 10px; border-radius:999px; font-size:14px; 
               background:rgba(0,0,0,.55); border:1px solid rgba(255,255,255,.18); display:none; }
    .ball.ready + .aim-hint{ display:block }

    .msg{ position:absolute; left:50%; transform:translateX(-50%); top:8px; padding:10px 14px; border-radius:12px; background:rgba(0,0,0,.5); 
          border:1px solid rgba(255,255,255,.15); font-size:14px; }

    /* Painel do Quiz */
    .panel{ background:linear-gradient(180deg,#0b1020,#0b0f1a); border:1px solid rgba(255,255,255,.08); border-radius:18px; 
            box-shadow:0 10px 40px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.03); padding:16px; display:grid; gap:12px; }

    .card{ background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:16px; }
    .question{ font-size:18px; line-height:1.3; margin:0 0 10px; }
    .options{ display:grid; gap:8px; }
    .options button{ background:#0f172a; color:var(--text); border:1px solid #26324a; padding:10px 12px; border-radius:12px; cursor:pointer; text-align:left; }
    .options button:hover{ border-color:#3b82f6; }
    .options button.correct{ border-color:#16a34a; background:#0b2a17; }
    .options button.wrong{ border-color:#ef4444; background:#2a0b0b; }

    .row{ display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .tag{ font-size:12px; color:var(--muted); }
    .btn{ background:linear-gradient(180deg,#1f2937,#111827); color:var(--text); border:1px solid #2a354a; padding:10px 14px; border-radius:12px; cursor:pointer; }
    .btn.primary{ background:linear-gradient(180deg,#14b8a6,#0ea5e9); border:none; color:#00131c; font-weight:700; }

    .score{ display:flex; gap:10px; }
    .chip{ background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1); padding:8px 10px; border-radius:12px; font-size:14px; }
    .chip.goal{ border-color:rgba(0,255,166,.35); }
    .chip.miss{ border-color:rgba(255,93,93,.35); }

    .toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:16px; background:rgba(0,0,0,.7); border:1px solid rgba(255,255,255,.12);
            padding:10px 14px; border-radius:10px; font-size:14px; opacity:0; pointer-events:none; transition:opacity .25s ease; }
    .toast.show{ opacity:1 }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Futebol + Quiz • Modo Difícil</h1>
      <div class="pill">
        Acerte para chutar ➜ <strong>goleiro mais rápido e gol menor</strong>
      </div>
    </header>

    <div class="grid">
      <!-- CAMPO / JOGO -->
      <section class="stadium">
        <div class="goal-area" id="goalArea">
          <div class="goal" id="goal">
            <div class="net"></div>
            <div class="keeper" id="keeper">GK</div>
            <div class="msg" id="hud">Responda o quiz para liberar o chute.</div>
          </div>

          <div class="box"></div>

          <div class="ball" id="ball" title="Clique no gol para chutar"></div>
          <div class="aim-hint">Clique em um ponto do gol para mirar</div>
        </div>
      </section>

      <!-- QUIZ / LADO DIREITO -->
      <aside class="panel">
        <div class="row">
          <div class="score">
            <div class="chip goal">Gols: <span id="goals">0</span></div>
            <div class="chip miss">Defesas/Erros: <span id="misses">0</span></div>
          </div>
          <button class="btn" id="reset">Reiniciar</button>
        </div>

        <div class="card" id="quizCard">
          <p class="tag">Pergunta <span id="qIndex">1</span>/<span id="qTotal">?</span></p>
          <h2 class="question" id="question">Carregando…</h2>
          <div class="options" id="options"></div>
        </div>

        <div class="card" style="display:none" id="endCard">
          <h2 style="margin:0 0 8px">Fim de jogo!</h2>
          <p id="endSummary">—</p>
          <button class="btn primary" id="playAgain">Jogar de novo</button>
        </div>
      </aside>
    </div>
  </div>

  <div class="toast" id="toast">—</div>

  <script>
    // Perguntas (modo difícil)
    const questions = [
      { q: "Quem marcou o gol do título da Copa do Mundo de 2014?", a:["Messi","Götze","Neymar","Klose"], ok:1 },
      { q: "Qual clube tem mais títulos da Champions League?", a:["Barcelona","Real Madrid","Milan","Liverpool"], ok:1 },
      { q: "Em que ano o Brasil foi campeão pela última vez na Copa do Mundo?", a:["1998","2002","2006","2010"], ok:1 },
      { q: "Quem é o maior artilheiro da história da Copa do Mundo?", a:["Pelé","Klose","Ronaldo Fenômeno","Mbappé"], ok:1 },
      { q: "Qual jogador ganhou 7 Bolas de Ouro até 2023?", a:["Cristiano Ronaldo","Pelé","Messi","Modric"], ok:2 },
      { q: "Quantos títulos mundiais tem a Alemanha?", a:["3","4","5","6"], ok:1 }
    ];

    // DOM refs
    const goal = document.getElementById('goal');
    const goalArea = document.getElementById('goalArea');
    const keeperEl = document.getElementById('keeper');
    const ball = document.getElementById('ball');
    const hud = document.getElementById('hud');
    const opts = document.getElementById('options');
    const qEl = document.getElementById('question');
    const qIndexEl = document.getElementById('qIndex');
    const qTotalEl = document.getElementById('qTotal');
    const goalsEl = document.getElementById('goals');
    const missEl = document.getElementById('misses');
    const resetBtn = document.getElementById('reset');
    const endCard = document.getElementById('endCard');
    const quizCard = document.getElementById('quizCard');
    const endSummary = document.getElementById('endSummary');
    const playAgain = document.getElementById('playAgain');
    const toast = document.getElementById('toast');

    // Estado
    let qIndex=0, canShoot=false, goals=0, misses=0;
    let keeperX=0, dir=1;        // posição do goleiro
    let keeperSpeed = 6;         // velocidade base (aumenta a cada gol)
    let animId = null;

    // ===== Util =====
    function toastMsg(t){
      toast.textContent=t;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1200);
    }

    function centerKeeper(){
      const gw = goal.clientWidth;
      const kw = keeperEl.clientWidth;
      keeperX = goal.offsetLeft + (gw-kw)/2;
      keeperEl.style.left = keeperX + 'px';
    }

    function centerBall(){
      ball.style.transition='none';
      ball.style.left='50%';
      ball.style.bottom='24px';
      ball.style.transform='translateX(-50%)';
      // reflow
      void ball.offsetWidth;
    }

    // ===== Goleiro se mexendo =====
    function tickKeeper(){
      const gw=goal.clientWidth, kw=keeperEl.clientWidth;
      const leftLimit=goal.offsetLeft+6;
      const rightLimit=goal.offsetLeft+gw-kw-6;

      keeperX+=dir*keeperSpeed;
      if(keeperX<=leftLimit){dir=1; keeperX=leftLimit;}
      if(keeperX>=rightLimit){dir=-1; keeperX=rightLimit;}
      keeperEl.style.left=keeperX+'px';

      animId = requestAnimationFrame(tickKeeper);
    }

    // ===== Quiz =====
    function renderQuestion(){
      qTotalEl.textContent=questions.length;
      qIndexEl.textContent=qIndex+1;
      const item=questions[qIndex];
      qEl.textContent=item.q;
      opts.innerHTML='';
      item.a.forEach((txt,i)=>{
        const b=document.createElement('button');
        b.textContent=txt;
        b.addEventListener('click',()=>selectAnswer(i));
        opts.appendChild(b);
      });
      hud.textContent='Responda o quiz para liberar o chute.';
      goal.classList.remove('aim');
      ball.classList.remove('ready');
      canShoot=false;
      endCard.style.display='none';
      quizCard.style.display='block';
    }

    function selectAnswer(i){
      const item=questions[qIndex];
      const buttons=[...opts.querySelectorAll('button')];
      buttons.forEach((b,idx)=>{
        b.disabled=true;
        if(idx===item.ok) b.classList.add('correct');
        if(idx===i && i!==item.ok) b.classList.add('wrong');
      });
      if(i===item.ok){
        hud.textContent='Certo! Clique no gol para chutar.';
        canShoot=true;
        ball.classList.add('ready');
        goal.classList.add('aim');
        toastMsg('Chute liberado!');
      }else{
        hud.textContent='Errou! Sem chute nesta rodada.';
        misses++; missEl.textContent=misses;
        nextRound();
      }
    }

    function nextRound(){
      setTimeout(()=>{
        qIndex++;
        if(qIndex>=questions.length){ finishGame(); }
        else { centerBall(); renderQuestion(); }
      }, 900);
    }

    function finishGame(){
      quizCard.style.display='none';
      endCard.style.display='block';
      const total=questions.length;
      endSummary.textContent=`Você fez ${goals} gol(s) e sofreu ${misses} defesa(s)/erro(s) em ${total} rodadas.`;
      hud.textContent='Fim da partida!';
      canShoot=false;
      ball.classList.remove('ready');
      goal.classList.remove('aim');
    }

    // ===== Chute =====
    function shootTo(clientX, clientY){
      if(!canShoot) return;

      const rectGoal = goal.getBoundingClientRect();
      const rectBall = ball.getBoundingClientRect();

      // Clampeia o clique dentro do retângulo do gol (bordas internas)
      const gx = Math.min(Math.max(clientX, rectGoal.left+6), rectGoal.right-6);
      const gy = Math.min(Math.max(clientY, rectGoal.top+6), rectGoal.bottom-6);

      const startX = rectBall.left + rectBall.width/2;
      const startY = rectBall.top + rectBall.height/2;

      // Calcula alvo relativo à bola (para animar com translate)
      const dx = gx - startX;
      const dy = gy - startY;

      // Anima a bola até o alvo
      ball.style.transition = 'transform 0.42s cubic-bezier(.22,.61,.36,1)';
      ball.style.transform = `translate(${dx}px, ${dy - (parseFloat(ball.style.bottom)||24)}px)`;

      // Verifica defesa x gol com base na posição ATUAL do goleiro
      const kRect = keeperEl.getBoundingClientRect();
      const isSaved = gx >= kRect.left && gx <= kRect.right && gy >= kRect.top && gy <= kRect.bottom;

      // Após a animação, registra resultado e vai pra próxima
      setTimeout(()=>{
        if(isSaved){
          hud.textContent='Defesa do goleiro!';
          misses++; missEl.textContent=misses;
          toastMsg('Defendeu!');
        }else{
          hud.textContent='GOOOOOOL!!!';
          goals++; goalsEl.textContent=goals;
          toastMsg('Gol! ⚽');
          // Aumenta dificuldade: goleiro um pouco mais rápido e gol “perceptivamente” menor
          keeperSpeed = Math.min(keeperSpeed + 0.6, 14);
          goal.style.height = Math.max(goal.clientHeight - 2, 120) + 'px';
          keeperEl.style.top = Math.min(parseFloat(getComputedStyle(keeperEl).top) + 1, 140) + 'px';
        }
        canShoot=false;
        ball.classList.remove('ready');
        goal.classList.remove('aim');
        nextRound();
      }, 430);
    }

    // ===== Reset / Init =====
    function resetGame(){
      cancelAnimationFrame(animId);
      qIndex=0; goals=0; misses=0;
      goalsEl.textContent=0; missEl.textContent=0;
      keeperSpeed=6; dir=1;
      endCard.style.display='none';
      quizCard.style.display='block';
      // restaurar tamanho do gol e posição do GK
      goal.style.height = '160px';
      keeperEl.style.top = '120px';

      centerBall();
      centerKeeper();
      renderQuestion();
      tickKeeper();
    }

    // Eventos
    goal.addEventListener('click', (e)=> {
      if(canShoot) shootTo(e.clientX, e.clientY);
    });

    resetBtn.addEventListener('click', resetGame);
    playAgain?.addEventListener('click', resetGame);
    window.addEventListener('resize', ()=>{ centerKeeper(); });

    // Start
    centerBall();
    centerKeeper();
    renderQuestion();
    tickKeeper();
  </script>
</body>
</html>
